{% extends "layout.html" %}

{% from "radios/macro.njk" import govukRadios %}
{% from "button/macro.njk" import govukButton %}
{% from "back-link/macro.njk" import govukBackLink %}

{% block pageTitle %}
My child feels safe at this school â€” Give feedback to schools
{% endblock %}

{% block beforeContent %}
{% endblock %}

{# surveyPager dictates the URL that the form POSTs to when the user clicks continue,
i.e. the next question unless they're editing,
in which case they're returned to the check your answers page #}
{% macro surveyPager() %}
{% if editing %}
  "/leave-feedback/check-your-answers"
{% elseif nextQuestion <= questionCount %}
  {{nextQuestion}}
{% elseif isFinalQuestion %}
  "/leave-feedback/additional-feedback"
{% else %}
  "/leave-feedback/check-your-answers"
{% endif %}
{% endmacro %}

{% block content %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">

    {% if editing %}
      {{ govukBackLink({
        text: "Back to your answers",
        href: "/leave-feedback/check-your-answers"
      }) }}
    {% else %}
      {{ govukBackLink({
        text: "Back",
        href: previousQuestion
      }) }}
    {% endif %}

    <span class="govuk-caption-xl">Question {{ questionId }} of {{ questionCount }}</span>

    <form action={{surveyPager()}} method="post" class="form">

      <div class="govuk-form-group">
        <fieldset class="govuk-fieldset">
          <legend class="govuk-fieldset__legend govuk-fieldset__legend--xl">
            <h1 class="govuk-fieldset__heading">
              {{ question.text }}
            </h1>
            {% if question.hintText !== null %}
              <span id="changed-name-hint" class="govuk-hint">
                {{ question.hintText }}
              </span>
            {% endif %}
          </legend>

          <div class="govuk-radios">
            {% for answer in question.answers %}
              <div class="govuk-radios__item">
                <input class="govuk-radios__input" id="{{ sanitise(question.text) + "-" + loop.index}}" name={{ sanitise(question.text) }} type="radio" value="{{ question.answers[loop.index0] }}" {{ checked(sanitise(question.text), question.answers[loop.index0]) }}>
                <label class="govuk-label govuk-radios__label" for="{{ sanitise(question.text) + "-" + loop.index}}">
                  {{ answer }}
                </label>
              </div>
            {% endfor %}
          </div>
        </fieldset>
      </div>

      {% if editing %}
        {{ govukButton({
          text: "Save your changes"
        }) }}
      {% else %}
        {{ govukButton({
          text: "Continue"
        }) }}
      {% endif %}

    </form>


  </div>
</div>


{% endblock %}

